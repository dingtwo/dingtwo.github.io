---
title: 评论添加网易云跟帖
date: 2017-04-27 16:41:07
tags: hexo
---

多说即将关闭(不过一直没用), 偶然看到了网易推出了云跟帖服务, 搞了一下, 首先配置完主观的评价一下, 和其他的产品相比优点暂时没看到, 列几个缺点:

- 站点配置不支持二级域名, 好多同学应该都使用github的pages服务, github.io的域名暂时在这里是不支持的, 而且在配置出错时不直接显示原因, `站名名称或者url已经存在`, 后来搞了个CNAME终于配置成功
- 文档里没什么有价值的东西, 官网下有站长qq群, 然而加了一天也没有回复, 不知道是不是rp的问题
- 官方可以设置回推接口, 即有评论后向指定url推送

![](http://7xr09w.com1.z0.glb.clouddn.com/42DA6473-ECC1-4313-9A7E-C11C94303B45.png)

文档里是这样写的

 ![](http://7xr09w.com1.z0.glb.clouddn.com/C4C2D958-89AF-4B94-8DAC-4086EE74D9F7.png)

哦是一个数组啊, 那我知道了, 还不确定是以`text/json`的形式还是`application/x-www-form-urlencoded`提交的, 两种方式都尝试没有正确答案
其实真实的数据是
``` json
{"data":"[{"title":"u4e91u8ddfu8d34u4f53u9a8cu6587u7ae0","url":"http://rasca1xsss","sourceId":"2","ctime":1461333601000,"comments":[{"cid":"2555053846","content":"u6765u81eau4e91u8ddfu8d34u7684u6d4bu8bd5u6570u636e","ctime":1471252987000,"pid":"0","ip":"220.181.102.177","source":"web","anonymous":false,"attachment":{"type":0,"desc":"","info":""},"user":{"userId":"95738681","nickname":"u7f51u6613u4e91u8ddfu8d34u5b98u65b9","avatar":"http://cms-bucket.nosdn.127.net/ec18d69788bb43aa866884633d212df720161220225628.jpg"}}]}]"}
```
妈的前面的data让你吃了啊!!!

在主题中添加支持就比较简单了, 我使用的主题用的`jade`模板, 当然`ejs`, `swig`也没多大区别, 换换语法就可以了

![](http://7xr09w.com1.z0.glb.clouddn.com/DF563CE9-F79C-418F-BD85-10F13C0CC322.png)

这里的`post.jade`是文章页的模板, 一般评论都是放在文末的, 找到这里有一句```include partial/comment```,

![](http://7xr09w.com1.z0.glb.clouddn.com/9A05779C-CD38-4504-8AC6-7D80D54FC9CA.png)

 即使不懂jade语法也知道了这里引入了评论的部分, 找到对应文件

![](http://7xr09w.com1.z0.glb.clouddn.com/2892E225-5A13-4F9C-AC8C-25145A921086.png)

可以看到分别有多说和disqus的布局结构, 把网易的对应的结构加上, 然后去修改js

模板中预先准备了多说和disqus的脚本, 在后面加一段网易的代码(在官方后台管理的获取代码位置可以获得)

![](http://7xr09w.com1.z0.glb.clouddn.com/F9DEF3A2-B721-4B86-96C3-C298B8B4784B.png)

结束!
